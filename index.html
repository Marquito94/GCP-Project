<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Static Site â€“ Home</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="data:," />
  <style>
    body { font-family: system-ui, Arial; margin: 40px; }
    pre { background:#f7f7f7; padding:12px; border-radius:8px; }
    a { display:inline-block; margin:4px 0; }
    .muted { color:#666; }
  </style>
</head>
<body>
  <h1>Welcome ðŸ‘‹</h1>
  <p>Three example paths that call the backend via Apigee:</p>
  <ul>
    <li><a href="/solutions/">/solutions</a></li>
    <li><a href="/delivery/">/delivery</a></li>
    <li><a href="/status/">/status</a></li>
  </ul>
  <p class="muted">Requests go to <code>https://api.pueba-web-dev.com</code> with a deploy-time JWT.</p>

  <h3>Response</h3>
  <pre id="out">Click a link aboveâ€¦</pre>

  <script type="module">
    const API = "https://api.pueba-web-dev.com";
    const out = document.getElementById("out");

    // Load the short-lived JWT created at deploy time
    const cfg = await fetch("/config.json", { cache: "no-store" }).then(r => r.json());

    async function call(path) {
      out.textContent = "Loadingâ€¦";
      try {
        const res = await fetch(API + path, {
          headers: {
            Accept: "application/json",
            Authorization: `Bearer ${cfg.jwt}`
          },
          credentials: "include"
        });
        const text = await res.text();
        if (!res.ok) throw new Error(`HTTP ${res.status}: ${text}`);
        try { out.textContent = JSON.stringify(JSON.parse(text), null, 2); }
        catch { out.textContent = text; }
      } catch (e) {
        out.textContent = e.message || String(e);
      }
    }

    function wire(href, apiPath) {
      const a = document.querySelector(`a[href="${href}"]`);
      if (!a) return;
      a.addEventListener("click", e => { e.preventDefault(); call(apiPath); });
    }

    wire("/solutions/", "/solutions/ping");
    wire("/delivery/", "/delivery/info");
    wire("/status/", "/status/health");
  </script>
</body>
</html>
